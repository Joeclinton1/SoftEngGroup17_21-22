(this["webpackJsonpchatbot-app"]=this["webpackJsonpchatbot-app"]||[]).push([[0],{304:function(e,t,n){},319:function(e,t){},321:function(e,t){},352:function(e,t){},354:function(e,t){},382:function(e,t){},384:function(e,t){},385:function(e,t){},390:function(e,t){},392:function(e,t){},398:function(e,t){},400:function(e,t){},419:function(e,t){},431:function(e,t){},434:function(e,t){},508:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),i=n(58),o=n.n(i),c=(n(304),n(16)),r=n(59),u=n(21),l=n(103),d=n.n(l),h=n(167),g=n(119),j=n(53),p=n(78),b=n(82),f=n(81),m=n(44),x=n(569),O=n(555),w=(n(306),n(51)),v={fontSize:0,chatColour:"b",lang:0,numResults:1,isSummarised:1},C=s.createContext(v),S=n(1);function y(e){var t=e.currentMessages,n=e.typingIndicatorStatus,s=e.handleSend,a=n?Object(S.jsx)(w.g,{content:"IBM chatbot is typing"}):0,i={0:"0.8em",1:"1em",2:"1.35em",3:"1.7em"},o={r:"#fac6c6",b:"#c6e3fa",g:"#c6facc",y:"#faf8c6"};return Object(S.jsx)(C.Consumer,{children:function(e){return Object(S.jsx)(w.b,{"data-colour":o[e.chatColour],"data-num-results":e.numResults,style:{fontSize:i[e.fontSize]},"data-show-conf":e.showConf,children:Object(S.jsxs)(w.a,{children:[Object(S.jsx)(w.f,{typingIndicator:a,children:t.map((function(e){return Object(S.jsx)(w.d,{direction:e.direction,children:Object(S.jsx)(w.d.Messages,{children:e.messages.map((function(e){return Object(S.jsx)(w.c,{model:{type:"html",payload:e.content}},e.id)}))})},e.id)}))}),Object(S.jsx)(w.e,{"data-testid":"message-input",onSend:s,placeholder:"Type message here"})]})})}})}new(n(311))({version:"2019-04-30",authenticator:new(0,n(502).IamAuthenticator)({apikey:"__Kp8R3pLrESr2vmVT4vRjsgBEo5ZKkWHPPar0pOOti2"}),serviceUrl:"https://api.eu-gb.discovery.watson.cloud.ibm.com/instances/d874b546-9b02-4c6a-bc6c-3042fedb37be"});window.localStorage.setItem("currentMessages",[]);var M=function e(t,n,s){Object(m.a)(this,e),this.id=t,this.direction=n,this.messages=s},k=function e(t,n){Object(m.a)(this,e),this.id=t,this.content=n},F=[new M(0,"incoming",[new k(0,"Hello, thank you for using IBM's chatbot assistance tool."),new k(1,"What would you like to know about IBM Cloud for Financial Services?")])],I={"Data sheet.pdf":"https://www.ibm.com/downloads/cas/1OLRGDBA?","What is IBM Cloud for Financial Services.html":"https://cloud.ibm.com/docs/overview?topic=overview-what-is-fscloud","IBM Cloud for Financial Services _ IBM.html":"https://www.ibm.com/cloud/financial-services","Cloud for FS FAQ & Field Guide.docx":"https://docs.google.com/document/d/1TAytTSvitpXWAl5kQUiDQDqOgx4KsLvB/edit?usp=sharing&ouid=113384434230823271599&rtpof=true&sd=true","Cloud for FS FAQ & Field Guide 1.docx":"https://docs.google.com/document/d/1eZEAA59VF6oy9lpXDgGlTUkV8oE4bZsb-vlVRsycrC8/edit?usp=sharing","Cloud for FS FAQ & Field Guide 2.docx":"https://docs.google.com/document/d/1DtpHtx5gpI9EhzWe81RGd9y3EJHumbPMor-f6G6x0WY/edit?usp=sharing","Cloud for FS FAQ & Field Guide 3.docx":"https://docs.google.com/document/d/1JgRh_lcxpBxp6rvxQUKyfRBxxqBP1hbC/edit?usp=sharing&ouid=113384434230823271599&rtpof=true&sd=true","Cloud for FS FAQ & Field Guide 4.docx":"https://docs.google.com/document/d/1nJqSfVz3RFG4540QxYEiWWTcIDShGDVV/edit?usp=sharing&ouid=113384434230823271599&rtpof=true&sd=true","Cloud for FS FAQ & Field Guide 5.docx":"https://docs.google.com/document/d/1vVHtCa50BmZJ1PmzP3FQ_y_jjwRjonu0XQe7nk3qKpk/edit?usp=sharing"},B=function(e){Object(b.a)(n,e);var t=Object(f.a)(n);function n(e){var s;Object(m.a)(this,n),(s=t.call(this,e)).colourChat=function(){var e=document.getElementsByClassName("cs-main-container")[0].getAttribute("data-colour");[".cs-message__content",".cs-message-input__content-editor",".cs-message-input__content-editor-wrapper"].forEach((function(t){var n,s=document.querySelectorAll(t),a=Object(g.a)(s);try{for(a.s();!(n=a.n()).done;){n.value.style.backgroundColor=e}}catch(i){a.e(i)}finally{a.f()}}))},s.componentDidMount=function(){s.colourChat()},s.componentDidUpdate=function(){s.colourChat()},s.getFile=function(){var e=Object(h.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),(n=new FileReader).onload=function(){var e=Object(h.a)(d.a.mark((function e(t){var n,a,i,o,c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.target.result,a=JSON.parse(n),i=[],o=0;o<a.length;o++){for(c=[],r=0;r<a[o].messages.length;r++)c.push(new k(a[o].messages[r].id,a[o].messages[r].content));i.push(new M(a[o].id,a[o].direction,c))}s.setState({currentMessages:i});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsText(t.target.files[0]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.receiveNextMessage=function(e,t){var n=s.state.currentMessages.length;if("empty"===e)s.setState({typingIndicatorStatus:!1}),s.setState({currentMessages:[].concat(Object(u.a)(s.state.currentMessages),[new M(n,"incoming",[new k(0,"I'm sorry, I couldn't understand. Could you please rephrase the question?")])])});else if(1==document.getElementsByClassName("cs-main-container")[0].getAttribute("data-show-conf")){s.setState({typingIndicatorStatus:!1});for(var a=0;a<e.length;a++)s.setState({currentMessages:[].concat(Object(u.a)(s.state.currentMessages),[new M(n,"incoming",[new k(0,e[a].substring(0,300)),new k(1,"Confidence score: ".concat(String(Number(t[a].toFixed(2)))))])])}),n+=1;s.setState({currentMessages:[].concat(Object(u.a)(s.state.currentMessages),[new M(n,"incoming",[new k(0,"Does this answer your question?")])])})}else{s.setState({typingIndicatorStatus:!1});for(var i=0;i<e.length;i++)s.setState({currentMessages:[].concat(Object(u.a)(s.state.currentMessages),[new M(n,"incoming",[new k(0,e[i].substring(0,1e3))])])}),n+=1;s.setState({currentMessages:[].concat(Object(u.a)(s.state.currentMessages),[new M(n,"incoming",[new k(0,"Does this answer your question?")])])})}window.localStorage.setItem("currentMessages",JSON.stringify(s.state.currentMessages))},s.saveFunction=function(){var e=document.createElement("a"),t=new Blob([JSON.stringify(s.state.currentMessages)],{type:"text/plain"});e.href=URL.createObjectURL(t);var n=(new Date).toLocaleString(),a=n.substring(0,10)+"_"+n.substring(12);e.download="transcipt_"+a+".json",document.body.appendChild(e),e.click()},s.handleSend=function(e){var t=s.state.currentMessages,n=t.length,a=new k(n,e),i=t[t.length-1];"outgoing"===i.direction?(i.messages.push(a),s.setState({currentMessages:[].concat(Object(u.a)(t.slice(0,-1)),[i])})):s.setState({currentMessages:[].concat(Object(u.a)(t),[new M(t.length,"outgoing",[a])])},(function(){s.callWD(e)})),window.localStorage.setItem("currentMessages",JSON.stringify(s.state.currentMessages)),s.setState({typingIndicatorStatus:!0})};var a="";return window.localStorage.getItem("currentMessages")&&(a=JSON.parse(window.localStorage.getItem("currentMessages"))),s.cookies=s.props.cookies,s.state={currentMessages:a||F,typingIndicatorStatus:!1},window.addEventListener("storage",(function(e){return s.storageChanged(e)})),s.storageChanged=s.storageChanged.bind(Object(p.a)(s)),s}return Object(j.a)(n,[{key:"storageChanged",value:function(e){"currentMessages"===e.key&&this.setState({currentMessages:e.newValue})}},{key:"callWD",value:function(e){var t=this;fetch("/queryWD?qtext=".concat(e)).then((function(e){return e.json()})).then((function(e){if(0==e.result.matching_results)setTimeout(t.receiveNextMessage("empty"),1e3);else{for(var n=e.result.passages,s=e.result.session_token,a=document.getElementsByClassName("cs-main-container")[0].getAttribute("data-num-results"),i=0;i<a;i++){var o=e.result.passages[i].document_id,c=s.concat("^").concat(o);fetch("/relev?rtext=".concat(c)).then((function(e){return console.log(e)}))}e.result.passages.map((function(e){return e.passage_score})).slice(0,a);var r=n.map((function(e){return e.passage_text})).slice(0,a);console.log(r);for(var u=[],l=0;l<a;l++)u.push(r[l]+"\nLink to document: "+I[e.result.results[l].extracted_metadata.filename]);console.log(u),setTimeout(t.receiveNextMessage(u),1e3)}})).catch((function(e){return e}))}},{key:"render",value:function(){var e=this;return Object(S.jsxs)(O.a,{direction:"column",spacing:2,style:{display:"flex",maxWidth:"500px",minWidth:"300px"},children:[Object(S.jsxs)(O.a,{direction:"row",spacing:2,children:[Object(S.jsx)(x.a,{variant:"outlined",onClick:function(){e.saveFunction()},children:"Export Current Chat"}),Object(S.jsx)("input",{type:"file",accept:"/*",style:{display:"none"},id:"contained-button-file",onChange:function(t){return e.getFile(t)}}),Object(S.jsx)("label",{htmlFor:"contained-button-file",children:Object(S.jsx)(x.a,{variant:"outlined",component:"span",children:" Load Previous Chat "})})]}),Object(S.jsx)(y,{currentMessages:this.state.currentMessages,typingIndicatorStatus:this.state.typingIndicatorStatus,handleSend:this.handleSend})]})}}]),n}(s.Component),D=B,R=n(4),W=n(574),_=n(567),A=n(573),E=n(572),G=n(563),L=function(e){var t=e.id,n=e.label,s=e.state,a=e.changeCookie,i=e.handleChange,o=e.MenuItems;return Object(S.jsxs)(E.a,{fullWidth:!0,children:[Object(S.jsx)(_.a,{id:"".concat(t,"-select-label"),children:n}),Object(S.jsx)(G.a,{labelId:"".concat(t,"-select-label"),id:"".concat(t,"-select"),value:s[t],label:n,onChange:function(e){i(t,e),a(t,e.target.value)},children:o.map((function(e,t){var n=Object(c.a)(e,2),s=n[0],a=n[1];return Object(S.jsx)(A.a,{value:s,children:a},t)}))})]})},N=function(e){Object(b.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(m.a)(this,n),(s=t.call(this,e)).componentDidMount=function(){s.setState(s.context)},s.handleChange=function(e,t){s.setState(Object(R.a)({},e,t.target.value),(function(){s.setOptions(s.state)}))},s.changeCookie=function(e,t){s.cookies.set(e,t,{path:"/"})},s.setOptions=s.props.setOptions,s.cookies=s.props.cookies,console.log(s.context),s.state={fontSize:0,chatColour:0,showConf:0,numResults:0,isSummarised:0},s.handleChange=s.handleChange.bind(Object(p.a)(s)),s}return Object(j.a)(n,[{key:"render",value:function(){return Object(S.jsxs)(W.a,{sx:{minWidth:400,display:"flex",flexDirection:"column",rowGap:"30px",outline:"1px solid #ccc",padding:"20px"},children:[Object(S.jsx)(L,{id:"fontSize",label:"Font Size",state:this.state,handleChange:this.handleChange,changeCookie:this.changeCookie,MenuItems:[[0,"Small"],[1,"Normal"],[2,"Large"],[3,"Very Large"]]}),Object(S.jsx)(L,{id:"chatColour",label:"Chat Colour",state:this.state,handleChange:this.handleChange,changeCookie:this.changeCookie,MenuItems:[["r","Red"],["g","Green"],["b","Blue"],["y","Yellow"]]}),Object(S.jsx)(L,{id:"showConf",label:"Show Confidence score?",state:this.state,handleChange:this.handleChange,changeCookie:this.changeCookie,MenuItems:[[1,"Yes"],[0,"No"]]}),Object(S.jsx)(L,{id:"numResults",label:"Number of Results to Display",state:this.state,handleChange:this.handleChange,changeCookie:this.changeCookie,MenuItems:[1,2,3,4,5].map((function(e){return[e,e]}))}),Object(S.jsx)(L,{id:"isSummarised",label:"Summarise Results?",state:this.state,handleChange:this.handleChange,changeCookie:this.changeCookie,MenuItems:[[1,"Yes"],[0,"No"]]})]})}}]),n}(s.Component);N.contextType=C;var T=N,q=function(e){Object(b.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(m.a)(this,n);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={},e}return Object(j.a)(n,[{key:"render",value:function(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h1",{children:"IBM Cloud for Financial Services Chatbot"}),Object(S.jsx)("h2",{children:"Answer queries quickly & easily"}),Object(S.jsx)("p",{children:" This chatbot has been created to aid IBM staff with any queries about the IBM Cloud for Financial Servies. Simply send a message with any of your queries about the Cloud for Financial Services and the chatbot will do its best to answer."}),Object(S.jsx)("h2",{children:"Struggling with what to ask?"}),Object(S.jsx)("p",{children:" Try asking: "}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:" What is IBM's Cloud for Financial services? "}),Object(S.jsx)("li",{children:" What services are offered by the IBM Cloud for Financial Services? "}),Object(S.jsx)("li",{children:" How is security implemented with the IBM Cloud for Financial Services?"})]}),Object(S.jsx)("h2",{children:"Other pages"}),Object(S.jsxs)("p",{children:["To change the format of the chat visit the ",Object(S.jsx)("a",{href:"/options",children:"options page"})]}),Object(S.jsxs)("p",{children:["Visit the ",Object(S.jsx)("a",{href:"https://www.ibm.com/uk-en/cloud/financial-services",children:" Cloud for Financial services "}),"webpage for more information about the product"]})]})}}]),n}(s.Component),z=q,Q=n(575),J=n(5),P=n(576),V=n(577),H=n(285),U=n.n(H),K=n(131),Y=n(17),Z=function(){switch(Object(Y.e)().pathname){case"/":return"Chat";case"/options":return"Options";case"/home":return"Home";default:return""}},X=Object(J.a)(Q.a,{shouldForwardProp:function(e){return"open"!==e&&"drawerWidth"!==e}})((function(e){var t=e.theme,n=e.open,s=e.drawerWidth;return Object(r.a)({transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},n&&{width:"calc(100% - ".concat(s,"px)"),marginLeft:"".concat(s,"px"),transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})})}));function $(e){return Object(S.jsx)(X,{position:"fixed",drawerWidth:e.drawerWidth,open:e.open,children:Object(S.jsxs)(P.a,{children:[Object(S.jsx)(V.a,{color:"inherit","aria-label":"open drawer",onClick:e.handleDrawerOpen,edge:"start",sx:Object(r.a)({mr:2},e.open&&{display:"none"}),children:Object(S.jsx)(U.a,{})}),Object(S.jsx)(K.a,{variant:"h4",noWrap:!0,component:"div",align:"center",sx:{flexGrow:1},children:Object(S.jsx)(Z,{})})]})})}var ee=Object(J.a)("div")((function(e){var t=e.theme;return Object(r.a)(Object(r.a)({display:"flex",alignItems:"center",padding:t.spacing(0,1)},t.mixins.toolbar),{},{justifyContent:"flex-end"})})),te=n(566),ne=n(559),se=n(560),ae=n(570),ie=n(561),oe=n(579),ce=n(100),re=n(286),ue=n.n(re),le=n(288),de=n.n(le),he=n(289),ge=n.n(he),je=n(287),pe=n.n(je),be=function(e){var t=e.text,n=e.icon,s=e.to;return Object(S.jsxs)(te.a,{button:!0,component:ce.b,to:s,children:[Object(S.jsx)(ne.a,{children:n}),Object(S.jsx)(se.a,{primary:t})]},t)};function fe(e){return Object(S.jsxs)(ae.a,{sx:{width:240,flexShrink:0,"& .MuiDrawer-paper":{width:240,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:e.open,children:[Object(S.jsx)(ee,{children:Object(S.jsx)(V.a,{onClick:e.handleDrawerClose,children:Object(S.jsx)(ue.a,{})})}),Object(S.jsx)(ie.a,{}),Object(S.jsx)(oe.a,{children:Object(S.jsx)(be,{text:"Home",icon:Object(S.jsx)(pe.a,{}),to:"home"})}),Object(S.jsx)(ie.a,{}),Object(S.jsx)(oe.a,{children:Object(S.jsx)(be,{text:"Chat",icon:Object(S.jsx)(de.a,{}),to:"/"})}),Object(S.jsx)(ie.a,{}),Object(S.jsx)(oe.a,{children:Object(S.jsx)(be,{text:"Options",icon:Object(S.jsx)(ge.a,{}),to:"options"})})]})}var me=n(571),xe=n(562),Oe=n(291),we=new Oe.a,ve=Object(J.a)("main")((function(e){var t=e.theme,n=e.open;return Object(r.a)({flexGrow:1,padding:t.spacing(3),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginLeft:"-".concat(240,"px")},n&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginLeft:0})}));var Ce=function(){var e=s.useState(!1),t=Object(c.a)(e,2),n=t[0],a=t[1];null==we.get("fontSize")&&we.set("fontSize",1,{path:"/"}),null==we.get("showConf")&&we.set("showConf",1,{path:"/"}),null==we.get("chatColour")&&we.set("chatColour","b",{path:"/"}),null==we.get("numResults")&&we.set("numResults",1,{path:"/"}),null==we.get("isSummarised")&&we.set("isSummarised",1,{path:"/"});var i=Object.fromEntries(["fontSize","chatColour","showConf","numResults","isSummarised"].map((function(e){return[e,we.get(e)]}))),o=s.useState(i),r=Object(c.a)(o,2),u=r[0],l=r[1];return Object(S.jsx)(C.Provider,{value:u,children:Object(S.jsx)(ce.a,{children:Object(S.jsxs)(me.a,{sx:{display:"flex",height:"100vh"},children:[Object(S.jsx)(xe.a,{}),Object(S.jsx)($,{handleDrawerOpen:function(){a(!0)}}),Object(S.jsx)(fe,{handleDrawerClose:function(){a(!1)},open:n}),Object(S.jsxs)(ve,{open:n,style:{padding:"0px"},children:[Object(S.jsx)(ee,{}),Object(S.jsx)("div",{style:{display:"flex",padding:"24px",justifyContent:"center",height:"calc(100vh - 64px)",margin:"auto"},children:Object(S.jsxs)(Y.c,{children:[Object(S.jsx)(Y.a,{path:"/",element:Object(S.jsx)(D,{cookies:we})}),Object(S.jsx)(Y.a,{path:"/options",element:Object(S.jsx)(T,{setOptions:l,cookies:we})}),Object(S.jsx)(Y.a,{path:"/home",element:Object(S.jsx)(z,{})})]})})]})]})})})},Se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,581)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),s(e),a(e),i(e),o(e)}))};o.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(Ce,{})}),document.getElementById("root")),Se()}},[[508,1,2]]]);
//# sourceMappingURL=main.d86f44d7.chunk.js.map